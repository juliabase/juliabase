{# -*- indent-tabs-mode: nil -*- #}
{% extends "samples/base.html" %}
{% comment %}
This file is part of JuliaBase, the samples database.

Copyright © 2008–2014 Forschungszentrum Jülich, Germany,
                      Marvin Goblet <m.goblet@fz-juelich.de>,
                      Torsten Bronger <t.bronger@fz-juelich.de>

You must not use, install, pass on, offer, sell, analyse, modify, or distribute
this software without explicit permission of the copyright holder.  If you have
received a copy of this software without the explicit permission of the
copyright holder, you must destroy it immediately and completely.
{% endcomment %}

{% load i18n %}
{% load juliabase %}

{% block frame_content %}
{% if claim.closed %}
  <p>{% trans 'This claim was either approved or withdrawn.' %}</p>
{% else %}
  <p>{% trans 'This claim is active and needs now to be approved by the reviewer or withdrawn by the requester.' %}</p>
  <table class="padding5">
    <tbody>
    <tr>
      <td>{% trans "Requester" %}:</td>
      <td>{{ claim.requester|get_really_full_name }}</td>
    </tr>
    <tr>
      <td>{% trans "Reviewer" %}:</td>
      <td>{{ claim.reviewer|get_really_full_name }}</td>
    </tr>
    </tbody>
  </table>
  <p style="margin-top: 4ex">
    {% blocktrans with claim.requester|get_really_full_name as name %}
      {{ name }} wishes to become the new “responsible person” of the following samples:
    {% endblocktrans %}
  </p>
  <table border="1" class="padding10" style="margin-bottom: 4ex">
    <thead>
    <tr>
      <th>{% trans "sample" %}</th>
      {% if is_reviewer %}
        <th>{% trans "currently responsible person" %}</th>
        <th>{% trans "purpose" %}</th>
        <th>{% trans "topic" %}</th>
      {% endif %}
    </tr>
    </thead>
    <tbody>
    {% for sample in claim.samples.all %}
      <tr>
        <td><a href="{{ sample.get_absolute_url }}">{{ sample }}</a></td>
        {% if is_reviewer %}
          <td>{{ sample.currently_responsible_person|get_really_full_name }}</td>
          <td>{{ sample.purpose }}</td>
          <td>{{ sample.topic|default:"" }}</td>
        {% endif %}
      </tr>
    {% endfor %}
    </tbody>
  </table>
  <form method="post">
    {% error_list approve _("General error") %}
    {% error_list withdraw _("General error") %}
    <table>
      <tbody>
      {% if is_reviewer %}
        <tr>
          {% input_field approve.close %}
        </tr>
      {% endif %}
      {% if is_requester %}
        <tr>
          {% input_field withdraw.close %}
        </tr>
      {% endif %}
      </tbody>
    </table>
    <p class="submit-button" style="clear: both"><input type="submit"/></p>
  </form>
{% endif %}
{% endblock %}
